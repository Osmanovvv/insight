// Mock-данные для инсайтов

export interface Insight {
  id: string;
  title: string;
  source: string;
  category: 'Технологии' | 'Энергетика' | 'Крипто' | 'Финансы';
  sentiment: 'positive' | 'neutral' | 'negative';
  impact: string;
  recommendation: string;
  date: string;
  keywords: string[];
  content: string;
  detailedAnalysis: string;
}

export const mockInsights: Insight[] = [
  {
    id: '1',
    title: 'Apple представила новые процессоры M4 с 40% приростом производительности',
    source: 'TechCrunch',
    category: 'Технологии',
    sentiment: 'positive',
    impact: 'Положительно для AAPL (+2-3% краткосрочно), усиление позиций на рынке процессоров',
    recommendation: 'Рассмотреть покупку AAPL на коррекции. Следить за квартальным отчётом.',
    date: '2025-09-28',
    keywords: ['apple', 'apple.com', 'технологии', 'процессоры'],
    content: 'Apple объявила о запуске новой линейки процессоров M4, которая демонстрирует впечатляющий прирост производительности на 40% по сравнению с предыдущим поколением M3. Новые чипы построены на 3-нанометровой технологии второго поколения и включают улучшенный Neural Engine с 16 ядрами для задач машинного обучения. Процессоры M4 будут устанавливаться в новые модели MacBook Pro, iMac и Mac mini, которые поступят в продажу в четвертом квартале 2025 года. Тесты производительности показывают значительное улучшение в многопоточных задачах, рендеринге видео 8K и обработке RAW-фотографий.',
    detailedAnalysis: 'Данный релиз укрепляет позиции Apple на рынке профессиональных компьютеров и создает серьезное конкурентное преимущество перед Intel и AMD. Исторически, анонсы новых процессоров Apple приводили к росту акций на 2-5% в течение недели после презентации. Рекомендуемая стратегия: открыть длинную позицию по AAPL при коррекции к уровню $175-180, с целевым уровнем $195-200 на горизонте 3-6 месяцев. Stop-loss установить на уровне $170. Также стоит обратить внимание на поставщиков компонентов Apple (TSMC, Broadcom), которые могут получить дополнительный импульс роста. Риски: возможное замедление продаж в Китае и общая макроэкономическая неопределенность. Следите за квартальным отчетом и комментариями менеджмента о спросе на новые продукты.'
  },
  {
    id: '2',
    title: 'Tesla увеличила производство электромобилей на 35% в третьем квартале',
    source: 'Bloomberg',
    category: 'Технологии',
    sentiment: 'positive',
    impact: 'Положительно для TSLA (+3-5%), укрепление доминирования на рынке EV',
    recommendation: 'Удерживать позиции в TSLA. Потенциал роста на горизонте 6-12 месяцев.',
    date: '2025-09-27',
    keywords: ['tesla', 'электромобили', 'технологии'],
    content: 'Tesla Inc. сообщила о рекордных показателях производства в третьем квартале 2025 года, произведя 485,000 электромобилей, что на 35% больше, чем в аналогичном периоде прошлого года. Рост обусловлен полной загрузкой новых мощностей в Техасе и Берлине, а также оптимизацией производственных процессов. Поставки составили 475,000 автомобилей, при этом Model Y остается самым продаваемым электромобилем в мире. Компания также объявила о планах запуска бюджетной модели стоимостью $25,000 в первой половине 2026 года.',
    detailedAnalysis: 'Увеличение производства Tesla на 35% значительно превышает прогнозы аналитиков (ожидалось 28-30%) и свидетельствует о сильном спросе на электромобили несмотря на макроэкономическую неопределенность. Рекомендуемая стратегия: для текущих держателей акций TSLA - удерживать позиции с возможностью докупки при снижении к $240-245. Целевая цена на горизонте 6-12 месяцев: $300-320. Для новых входов - дождаться коррекции после релиза квартального отчета. Драйверы роста: запуск бюджетной модели, расширение производства, потенциальное одобрение Full Self-Driving в Европе. Риски: усиление конкуренции со стороны китайских производителей (BYD, NIO), возможные задержки с новыми моделями, волатильность связанная с активностью Илона Маска в социальных сетях. Также обратите внимание на поставщиков литиевых батарей (ALB, SQM) как смежную инвестиционную идею.'
  },
  {
    id: '3',
    title: 'Цены на нефть Brent выросли до $95 за баррель на фоне сокращения запасов',
    source: 'Reuters',
    category: 'Энергетика',
    sentiment: 'neutral',
    impact: 'Положительно для нефтяных компаний (XOM, CVX), негативно для авиакомпаний',
    recommendation: 'Хеджировать риски в транспортном секторе. Рассмотреть нефтяные ETF.',
    date: '2025-09-26',
    keywords: ['oil', 'нефть', 'энергетика', 'brent'],
    content: 'Цены на нефть марки Brent достигли отметки $95 за баррель, максимума с начала 2024 года, на фоне неожиданного сокращения запасов в США на 7.5 млн баррелей. Дополнительное давление на рынок оказывает решение ОПЕК+ продлить добровольные сокращения добычи на 1.5 млн баррелей в сутки до конца 2025 года. Геополитическая напряженность на Ближнем Востоке также поддерживает цены. Аналитики Goldman Sachs повысили прогноз средней цены Brent на четвертый квартал до $95-100 за баррель.',
    detailedAnalysis: 'Текущая ситуация на нефтяном рынке создает разнонаправленные инвестиционные возможности. Для нефтегазового сектора: рекомендуется открытие позиций в ExxonMobil (XOM) и Chevron (CVX), которые исторически показывают лучшую динамику при ценах выше $90/барр. Альтернативный вариант - нефтяной ETF (USO, XLE) для диверсификации рисков. Целевой горизонт 3-6 месяцев, потенциал роста 10-15%. Для транспортного сектора: рекомендуется хеджирование рисков через шортовые позиции по авиакомпаниям (DAL, UAL) или покупку put-опционов. Высокие цены на топливо негативно влияют на маржинальность авиаперевозчиков. Для потребительского сектора: избегать компаний с высокой зависимостью от транспортных издержек. Риски: возможное замедление мировой экономики может привести к снижению спроса на нефть; разрешение геополитических конфликтов снизит премию за риск. Следите за еженедельными данными EIA по запасам и заявлениями ОПЕК+.'
  },
  {
    id: '4',
    title: 'Bitcoin преодолел отметку $45,000 после новостей о ETF',
    source: 'CoinDesk',
    category: 'Крипто',
    sentiment: 'positive',
    impact: 'Положительно для BTC и крипторынка в целом (+5-10% краткосрочно)',
    recommendation: 'Взять частичную прибыль на пиках. Следить за объёмами торгов.',
    date: '2025-09-25',
    keywords: ['bitcoin', 'btc', 'крипто', 'криптовалюта'],
    content: 'Bitcoin пробил психологически важный уровень $45,000 после объявления BlackRock о запуске спотового Bitcoin ETF с минимальной комиссией 0.2%. Это третий крупнейший управляющий активами в мире, присоединившийся к рынку криптовалютных ETF. За последние 24 часа объем торгов BTC вырос на 65% до $32 млрд, что свидетельствует о сильном институциональном интересе. Альткоины также демонстрируют рост: Ethereum +8%, Solana +12%, Cardano +15%.',
    detailedAnalysis: 'Пробой уровня $45,000 является технически значимым событием, которое может открыть путь к тестированию исторических максимумов около $69,000. Рекомендуемая стратегия зависит от вашей позиции: для текущих держателей - зафиксировать 30-40% прибыли на текущих уровнях, остальное держать с trailing stop на уровне $42,000. Для новых входов - дождаться коррекции к зоне $42,000-43,000 для более выгодной точки входа. Целевые уровни: краткосрочно $48,000-50,000 (4-6 недель), среднесрочно $55,000-60,000 (3-6 месяцев). Драйверы роста: институциональное принятие через ETF, приближающийся халвинг (апрель 2026), улучшение макроэкономической ситуации. Риски: высокая волатильность криптовалют, регуляторные риски, возможная коррекция после быстрого роста. Рекомендуется не инвестировать более 5-10% портфеля в криптовалюты. Альтернативные варианты: рассмотреть инвестиции в компании-майнеры (MARA, RIOT) или блокчейн-технологические компании для косвенной экспозиции.'
  },
  {
    id: '5',
    title: 'ФРС сохранила ключевую ставку на уровне 5.5%',
    source: 'Financial Times',
    category: 'Финансы',
    sentiment: 'neutral',
    impact: 'Нейтрально для рынков. Ожидается волатильность в краткосрочной перспективе',
    recommendation: 'Диверсификация портфеля. Увеличить долю защитных активов.',
    date: '2025-09-24',
    keywords: ['фрс', 'ставка', 'финансы', 'экономика'],
    content: 'Федеральная резервная система США единогласно проголосовала за сохранение ключевой процентной ставки на уровне 5.25-5.50%, что соответствовало ожиданиям рынка. В заявлении FOMC отмечается замедление инфляции до 3.2% (с пикового 9.1%), но подчеркивается необходимость дальнейшего прогресса для достижения целевых 2%. Председатель ФРС Джером Пауэлл на пресс-конференции заявил, что решения по ставке будут приниматься на основе входящих данных, не исключая ни повышения, ни снижения ставок в будущем.',
    detailedAnalysis: 'Решение ФРС сохранить ставку было ожидаемым, однако риторика остается сдержанно-ястребиной ("higher for longer"), что создает неопределенность для рынков. Рекомендуемая портфельная стратегия: увеличить долю защитных активов до 25-30% (государственные облигации США с дюрацией 1-3 года, gold ETF). Для акционной части портфеля смещать акцент на defensive sectors: здравоохранение (JNJ, UNH), товары первой необходимости (PG, KO), utilities (NEE, DUK). Сократить позиции в growth акциях и технологических компаниях с высокими мультипликаторами. Рассмотреть увеличение денежной позиции до 10-15% для использования возможностей при коррекции. Волатильность (VIX) может вырасти до 20-25 пунктов в ближайшие недели. Ключевые данные для отслеживания: ежемесячная инфляция (CPI), рынок труда (NFP, безработица), комментарии членов FOMC. Возможное снижение ставки не ожидается ранее второго квартала 2026 года. При этом сохраняется риск дополнительного повышения ставки при ускорении инфляции.'
  },
  {
    id: '6',
    title: 'Microsoft инвестирует $10 млрд в развитие AI-инфраструктуры',
    source: 'Wall Street Journal',
    category: 'Технологии',
    sentiment: 'positive',
    impact: 'Положительно для MSFT (+2-4%), усиление позиций в AI-секторе',
    recommendation: 'Долгосрочное удержание MSFT. Потенциал роста 15-20% на год.',
    date: '2025-09-23',
    keywords: ['microsoft', 'ai', 'технологии', 'инвестиции'],
    content: 'Microsoft объявила о крупнейшей в своей истории инвестиции в размере $10 млрд для развития AI-инфраструктуры, включая строительство новых дата-центров и приобретение специализированных чипов Nvidia H100. Компания также расширяет партнерство с OpenAI и планирует интегрировать GPT-5 во все продукты экосистемы Microsoft, включая Office 365, Azure и Windows. По прогнозам аналитиков, AI-направление может принести Microsoft дополнительные $50-70 млрд выручки к 2027 году.',
    detailedAnalysis: 'Массивные инвестиции Microsoft в AI-инфраструктуру укрепляют лидерские позиции компании в одном из самых перспективных технологических направлений. Рекомендуемая стратегия: долгосрочное удержание акций MSFT (минимум 12-24 месяца) с целевой ценой $450-480 (текущая ~$380). Для инвесторов без позиции - постепенный набор при коррекциях к уровням $360-370. Ключевые драйверы роста: монетизация AI через Azure (+40-50% роста AI-выручки ежегодно), успех Microsoft 365 Copilot (уже 1.5 млн корпоративных подписчиков), рост облачного бизнеса Azure. Microsoft также получает преимущество от эксклюзивного доступа к технологиям OpenAI. Смежные инвестиционные идеи: Nvidia (поставщик чипов для AI), Broadcom (сетевое оборудование), Digital Realty (дата-центры). Риски: высокая капиталоемкость AI-инфраструктуры может давить на маржинальность в краткосрочной перспективе; усиление конкуренции со стороны Google, Amazon; регуляторные риски в области AI. Дивидендная доходность ~0.8% является приятным бонусом для долгосрочных инвесторов.'
  },
  {
    id: '7',
    title: 'Добыча газа в Европе сократилась на 15% из-за технических проблем',
    source: 'Energy News',
    category: 'Энергетика',
    sentiment: 'negative',
    impact: 'Рост цен на газ в Европе (+8-12%), давление на промышленность',
    recommendation: 'Осторожность с европейскими акциями. Рассмотреть газовые фьючерсы.',
    date: '2025-09-22',
    keywords: ['газ', 'энергетика', 'европа'],
    content: 'Добыча природного газа в Северном море сократилась на 15% из-за внеплановых остановок на норвежских месторождениях Troll и Oseberg. Технические проблемы затронули мощности, производящие около 50 млн кубометров газа в сутки. Цены на газ в Европе (TTF) выросли до €45 за мегаватт-час, максимума за последние 4 месяца. Ситуация усугубляется низким уровнем запасов в подземных хранилищах (72% против обычных 85% на этот период года) перед отопительным сезоном.',
    detailedAnalysis: 'Сокращение добычи газа в Европе создает серьезные риски для энергоемких отраслей и европейской экономики в целом. Инвестиционные рекомендации: избегать или сокращать позиции в европейских промышленных компаниях (химия, металлургия, удобрения), которые сильно зависят от цен на газ. Шорт или put-опционы на BASF, ThyssenKrupp, Yara могут принести прибыль на горизонте 1-3 месяцев. Рассмотреть длинные позиции по газовым фьючерсам (Dutch TTF) или ETF природного газа (UNG), но с осторожностью из-за высокой волатильности. Альтернативный вариант - инвестиции в альтернативную энергетику Европы (Orsted, Iberdrola, NextEra Energy). Для hedge против энергетического кризиса можно рассмотреть золото и защитные активы. Следите за: прогнозом погоды на зиму (холодная зима усугубит ситуацию), новостями о возобновлении норвежской добычи, политикой ЕЦБ (высокие цены на энергию могут усилить инфляционное давление). Потенциальное позитивное развитие - запуск новых LNG-терминалов в Германии и Нидерландах может частично компенсировать дефицит.'
  },
  {
    id: '8',
    title: 'Ethereum обновление Shanghai успешно запущено',
    source: 'CryptoNews',
    category: 'Крипто',
    sentiment: 'positive',
    impact: 'Положительно для ETH (+6-8%), улучшение функциональности сети',
    recommendation: 'Рассмотреть долгосрочную позицию в ETH. Следить за DeFi-проектами.',
    date: '2025-09-21',
    keywords: ['ethereum', 'eth', 'крипто', 'блокчейн'],
    content: 'Сеть Ethereum успешно активировала долгожданное обновление Shanghai (EIP-4895), которое впервые позволяет валидаторам выводить застейканные ETH со стейкинг-контрактов. За первые 48 часов после обновления было снято около 1.2 млн ETH (около $2.3 млрд), что меньше ожидаемых 2-3 млн ETH. Это свидетельствует о доверии валидаторов к сети и их готовности продолжать стейкинг. Цена ETH выросла на 7.5% до $1,950, общая стоимость застейканных средств превысила $45 млрд.',
    detailedAnalysis: 'Успешное обновление Shanghai является важной вехой для Ethereum, устраняя одну из главных проблем - невозможность вывода средств из стейкинга. Рекомендуемая инвестиционная стратегия: открыть или увеличить долгосрочную позицию в ETH с целевыми уровнями $2,400-2,600 на горизонте 6-12 месяцев. Для консервативных инвесторов - рассмотреть стейкинг ETH через легальные платформы (Lido, Coinbase) с доходностью 4-5% годовых. Ключевые драйверы роста: снижение инфляции ETH (после перехода на PoS инфляция ~0.5% против 4% ранее), рост использования L2-решений (Arbitrum, Optimism, Base), укрепление позиций Ethereum в DeFi и NFT. Смежные инвестиционные возможности: токены DeFi-проектов на Ethereum (AAVE, UNI, MKR), L2-токены (ARB, OP), инфраструктурные проекты (LDO). Риски: усиление конкуренции со стороны альтернативных блокчейнов (Solana, Avalanche), регуляторная неопределенность относительно классификации ETH как ценной бумаги, высокая волатильность криптовалют. Рекомендуется ограничить долю ETH в портфеле до 3-7% от общего капитала и использовать DCA-стратегию для минимизации рисков входа.'
  }
];

export const filterInsights = (
  insights: Insight[], 
  category?: string, 
  keywords?: string[],
  sentiment?: 'positive' | 'neutral' | 'negative',
  dateRange?: string
): Insight[] => {
  let filtered = [...insights];
  
  if (category && category !== 'Все') {
    filtered = filtered.filter(insight => insight.category === category);
  }
  
  if (keywords && keywords.length > 0) {
    filtered = filtered.filter(insight =>
      keywords.some(keyword =>
        insight.keywords.some(k => k.toLowerCase().includes(keyword.toLowerCase())) ||
        insight.title.toLowerCase().includes(keyword.toLowerCase())
      )
    );
  }
  
  if (sentiment) {
    filtered = filtered.filter(insight => insight.sentiment === sentiment);
  }
  
  if (dateRange && dateRange !== 'Все') {
    const now = new Date();
    const insightDate = new Date(insights[0].date); // Используем как базу
    
    if (dateRange === 'День') {
      const oneDayAgo = new Date(now.getTime() - 24 * 60 * 60 * 1000);
      filtered = filtered.filter(insight => new Date(insight.date) >= oneDayAgo);
    } else if (dateRange === 'Неделя') {
      const oneWeekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
      filtered = filtered.filter(insight => new Date(insight.date) >= oneWeekAgo);
    } else if (dateRange === 'Месяц') {
      const oneMonthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
      filtered = filtered.filter(insight => new Date(insight.date) >= oneMonthAgo);
    }
  }
  
  return filtered;
};

export const saveSubscription = (email: string) => {
  localStorage.setItem('insight_subscription', email);
};

export const getSubscription = (): string | null => {
  return localStorage.getItem('insight_subscription');
};

export const savePricingRequest = (email: string, plan: string) => {
  const requests = JSON.parse(localStorage.getItem('insight_pricing_requests') || '[]');
  requests.push({ email, plan, date: new Date().toISOString() });
  localStorage.setItem('insight_pricing_requests', JSON.stringify(requests));
};
